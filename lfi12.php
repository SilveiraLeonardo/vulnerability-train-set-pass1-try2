
<?php
    // Include the external file using an absolute path
    require_once(__DIR__ . '/../common/header.php');

    // Sanitize and validate 'file'
    $file = isset($_GET['file']) ? htmlspecialchars($_GET['file'], ENT_QUOTES, 'UTF-8') : '';

    // Validate 'stylepath' and set the default style file
    $allowedStyles = array('style1', 'style2', 'style3');
    $defaultStylePath = 'styles/default.php';
    $stylePath = isset($_GET['stylepath']) ? $_GET['stylepath'] : '';

    if (!in_array($stylePath, $allowedStyles)) {
        $stylePath = $defaultStylePath;
    } else {
        $stylePath = 'styles/' . $stylePath . '.php';
    }
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"><!-- I added this meta -->
    <title>Fixed Vulnerabilities</title>
</head>
<body>
    <form action="/api/index.php" method="GET">
        <input type="text" name="file" value="<?php echo $file; ?>">
        <input type="hidden" name="style" value="<?php echo $stylePath; ?>">
    </form>

    <?php include($stylePath); ?>
</body>
</html>
