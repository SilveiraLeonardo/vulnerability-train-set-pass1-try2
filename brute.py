
#!/usr/bin/env python3

import subprocess
import sys
import shlex
import re

def is_alphanumeric(input_str):
    return bool(re.match('^[a-zA-Z0-9]*$', input_str))

# Simple function to sanitize input
def sanitize_input(input_str):
    return re.sub('[^a-zA-Z0-9]', '', input_str)

program = sys.argv[1]
username = sys.argv[2]

# Check if input is alphanumeric and not an empty string
if not is_alphanumeric(program) or not is_alphanumeric(username):
    print("Invalid input! Please provide alphanumeric values for program and username.")
    sys.exit(1)

# Sanitize input
program = sanitize_input(program)
username = sanitize_input(username)

passwords = [
    '1',
    '12',
    '123',
    '1234',
    '12345',
    '123456',
    '12345678',
    '123123123',
]

for password in passwords:
    password = sanitize_input(password)
    # Use shlex.split() to safely create a list of arguments
    command_arguments = shlex.split('{} {} {}'.format(program, username, password))
    
    result = subprocess.run(command_arguments, stdout=subprocess.DEVNULL)
    
    if result.returncode == 0:
        print("Cracked! User: {} Password: {}".format(username, password))
        break
