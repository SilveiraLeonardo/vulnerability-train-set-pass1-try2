
<?php
session_start();
$token = bin2hex(random_bytes(32));
$_SESSION['csrf_token'] = $token;
include("../common/header.php");
?>

<form action="/api/index.php" method="POST">
    <input type="hidden" name="csrf_token" value="<?php echo htmlspecialchars($token, ENT_QUOTES, 'UTF-8'); ?>">
    <input type="text" name="page">
    <input type="submit" value="Submit">
</form>

<?php
if (isset($_POST['csrf_token']) && hash_equals($_POST['csrf_token'], $_SESSION['csrf_token'])) {
    $allowed_pages = ['page1.php', 'page2.php', 'page3.php'];
    $page = filter_input(INPUT_POST, 'page', FILTER_SANITIZE_STRING);

    if (in_array($page, $allowed_pages)) {
        include($page);
    } else {
        // Show an error message or include a default page
    }
} else {
    // Show an error message
}
?>
