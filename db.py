
import os
import sqlite3
from passlib.hash import pbkdf2_sha256

def db_init():

    users = [
        ('admin', pbkdf2_sha256.hash(os.environ.get('ADMIN_PASSWORD', 'ComplexPassword1'))),
        ('john', pbkdf2_sha256.hash(os.environ.get('JOHN_PASSWORD', 'StrongPassw0rd'))),
        ('tim', pbkdf2_sha256.hash(os.environ.get('TIM_PASSWORD', 'SecureP@ssphrase')))
    ]

    try:
        conn = sqlite3.connect('users.sqlite')
        c = conn.cursor()
        c.execute("CREATE TABLE IF NOT EXISTS users (user text, password text, failures int)")

        for u, p in users:
            c.execute("INSERT INTO users (user, password, failures) VALUES (?, ?, ?)", (u, p, 0))

        conn.commit()
    except sqlite3.Error as e:
        print("Error occurred:", e)
    finally:
        if conn:
            conn.close()


if __name__ == '__main__':
    db_init()
