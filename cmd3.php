
<?php
    session_start();
    if (empty($_SESSION['csrf_token'])) {
        $_SESSION['csrf_token'] = bin2hex(random_bytes(32));
    }

    include("../common/header.php");
?>

<?php
    hint("something something something placeholder placeholder placeholder");
?>

<form action="/CMD-3/index.php" method="POST">
    Whois: <input type="text" name="domain">
    <input type="hidden" name="csrf_token" value="<?php echo htmlspecialchars($_SESSION['csrf_token']); ?>">
</form>

<pre>
<?php
    if ($_SERVER["REQUEST_METHOD"] == "POST" && isset($_SESSION['csrf_token']) && $_SESSION['csrf_token'] === $_POST['csrf_token']) {
        $domain = escapeshellarg($_POST["domain"]);
        system("/usr/bin/whois " . $domain);
    }
?>
</pre>
