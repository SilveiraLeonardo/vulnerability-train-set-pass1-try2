
<?php

class ViewFile {
    public $filename = '';

    public function __toString() {
        return file_get_contents($this->filename);
    }
}

// This function safely deserializes data using a limited set of allowed classes (only ViewFile)
function safeDeserialization($data) {
    $allowed_classes = ['ViewFile'];
    return unserialize($data, ['allowed_classes' => $allowed_classes]);
}

if (isset($_GET['page'])) {
    $encoded_data = filter_input(INPUT_GET, 'page', FILTER_SANITIZE_STRING);
    $decoded_data = base64_decode($encoded_data);

    $pdfobject = safeDeserialization($decoded_data);
} else {
    $pdfobject = new ViewFile();
}

?>
